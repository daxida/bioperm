# (i)  Produce the constrained sequence graph G = GrC(S, k, M).

# (ii) Uniformly generate a random Eulerian trail in G, and take its trace T .

# (iii) If T has no perfect configuration then goto (ii).

#( iv) Compute the number N of Eulerian trails corresponding to this particular trace T .

# (v) Return T with probability 1/N , or goto (ii).
